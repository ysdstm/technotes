#### 说明

一年前按照[NAS群晖DSM 进阶教程 篇一：NAS群晖DSM 5.0-4458 傻瓜安装教程](http://post.smzdm.com/p/36280/)安装了NAS，后来多次想更新，但觉得很麻烦，终于在今年过年期间有时间折腾了，此时是2016-02-08 23:27，按照网上的教程刷U盘，安装系统，最终无法添加存储空间，提示联机失败。几乎放弃。  
又按照[NAS群晖DSM 进阶教程 篇四：DSM5.0升级DSM5.1 5022](http://post.smzdm.com/p/119984/)重新刷了5022版本，没有修改配置文件中的U盘VID和PID。终于成功。  

一开始是想刷到最新版本，按照[群晖固件5.1 5022-5.2 5644.4，以及对应的XPEnoboot工具](http://www.nasyun.com/thread-24433-1-1.html)，保存了百度云中的文件，下载了U盘镜像文件，和群晖系统，最终失败。  
当时是下载的`XPEnoboot_DS3615xs_5.2-5644.1.img`刷的U盘，修改了VID和PID，上传了`DSM_DS3615xs_5644.pat`，失败后怀疑是否要修改，但这种可能性较小。还有一个`XPEnoboot_DS3615xs_5.2-5644.4.img`的镜像文件，但提示是需要1，所以一开始没有使用该镜像。  

在5022版本刷成功后，重新刷了`XPEnoboot_DS3615xs_5.2-5644.4.img`，上传了`DSM_DS3615xs_5644.pat`，没有完全格式化硬盘，成功了！后来又更新了`synology_bromolow_3615xs.5644.3.pat`，存储空间可用。版本是当前的最新版，`DSM 5.2-5644 Update 3`。  

之前有一个三星的320G的硬盘，在今天第一次开机，升级系统前，就提示SMART错误，不知道是硬盘不好，还是因为黑群晖比较伤硬盘，好在没有重要的数据，都只是上传测试的。  
看来除非NAS可靠，否则还是用传统的方式备份数据吧。麻烦点，多拷贝几个备份。NAS整天开启，损伤硬盘，要是遭到黑客入侵，那更加完蛋。  

#### 安装/升级简要过程

网上搜索到的都是升级教程，其实升级也就是全新安装，保留数据分区罢了，一开始以为要什么必要条件，就忽略了这些教程。  

1. 将`5022`教程中提到的网盘文件保存到自己的网盘，然后下载。见我的网盘-黑群晖-DSM-5.1-5022，下载`win32diskimager`，用来写入U盘镜像，使用的是`XPEnoboot_DS3615xs_5.1-5022.2.img`。  
2. 将U盘连接电脑，启动，选择启动项第3项，使用`Synology Assistant`自动查找主机，并写入系统，之前是通过该工具上传系统，后来是通过网页页面`192.168.1.*:5000/web_index.html`初始化硬盘并上传的镜像，之前失败`可能与上传的方式有关`。  
3. 上传`DSM_DS3615xs_5022.pat`系统，设置用户名，进入系统后，能够新增存储空间。  
4. 我的网盘-黑群晖-DSM XPE，使用`XPEnoboot_DS3615xs_5.2-5644.4.img`重刷U盘，再通过网页上传`DSM_DS3615xs_5644.pat`，初始化硬盘选择第2项。成功！  
5. 重启后，选择引导项第3项，升级`synology_bromolow_3615xs.5644.3.pat`，无异常。

#### 后记

有时间需要再次尝试，刷`XPEnoboot_DS3615xs_5.2-5644.4.img`，修改其中的配置文件，更改VID和PID，隐藏U盘文件。格式化整个硬盘，网页方式上传`DSM_DS3615xs_5644.pat`，查看是否能正常新增存储空间。  

#### 备注

NAS系统是保存在硬盘当中的，U盘只起到引导的作用。  

#### 后续

后来再次按照后记测试了一下，可以使用，重启进入第3项，可以自动更新。  2016-02-09 00:25  
网盘内容有必要下载下来保存一下，百度还是会抽风的。  

#### 登录

用户名：root，密码：与web登录密码一致  
`su: must be suid to work properly`  
chmod 4755 /bin/busybox

#### 修改ssh端口

参考`http://www.paoto.com/2014/05/群晖synologynas的安全设置之sshd.html`

#### GLPI

缺省 登录名/密码是：  

管理员帐号是 glpi/glpi  
技术员帐号是 tech/tech  
普通帐号是 normal/normal  
只能发布的帐号是 post-only/postonly  
您可以删除或修改这些帐号和初始数据。  

#### MariaDB

初始密码为空  